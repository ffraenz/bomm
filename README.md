
# Bomm

Bomm is a command line program written in C for breaking Enigma ciphertext in a ciphertext-only attack. It is being developed as part of the Bachelor thesis *Breaking Enigma ciphertext in 2023* by Fränz Friederes.

## Getting started

JSON formatted query files are used as the input of the program. A query primarily consists of the ciphertext to be tested, a key space (referencing known or custom wheels and wirings), and a set of passes to be executed for each scrambler key attacking the plugboard and scoring the putative plaintext. A schema for query files can be found at `data/schemas/query.json`. Examples for it are stored in `data/queries`.

The following CLI options are available:

- `-h`, `--help` - Display the help message
- `-n`, `--num-hold` - Number of hold elements to collect
- `-t`, `--num-threads` - Number of concurrent threads to use
- `-q`, `--quiet` - Enable quiet mode
- `-v`, `--verbose` - Enable verbose mode

To run a query, simply provide its path as the only argument when executing the binary:

```bash
./build/bomm ./data/queries/authentic-1945-01-10.json
```

This will result in the following view that is kept up-to-date while processing the query:

```
┌──────┬───────────────────────────────────────────────────────────────────────┐
│ Bomm │ Progress     80.521 % │ Elapsed      11:37:03 │ Remaining    00:57:48 │
├──────┴───────────────────────────────────────────────────────────┬───────────┤
│ qtstwernnixderuderilubrgtxsisielnunntxknsurvxgundasrvieskuesetxn   -8.543918 │
│ UKW-B,II,I,V,ETW-ABC aaaqa ayhva bz cj dy ex fp gr ln ov tu                  │
├──────────────────────────────────────────────────────────────────┬───────────┤
│ sgrlazmrerinbajxbestqdsunuehauqqvrueesieranfnrpsoninixhauenansvm   -8.551549 │
│ UKW-B,IV,II,V,ETW-ABC aaana abjta am bu ct dk er gj hq lv nw oy pz           │
├──────────────────────────────────────────────────────────────────┬───────────┤
│ pumaszworunxfuevenzbeivsmtemxtexbenstbasobenfxkxfeervnyytppkbder   -8.557691 │
│ UKW-B,V,I,III,ETW-ABC aaaea amjia at bk cl dh ei gr jp mn ou qv yz           │
├──────────────────────────────────────────────────────────────────┬───────────┤
│ lamriexvxstuesiekomxnendepmpvxlorssielfgerhdyptfinrnestoporierdu   -8.578461 │
│ UKW-B,II,V,I,ETW-ABC aaaea amtta ac dz em gq hn jr ov pw st ux               │
├──────────────────────────────────────────────────────────────────┬───────────┤
│ xzdrenersilcyaseznxrossantxborxxrwkhstmtrquexzanesninntehelaglei   -8.578493 │
│ UKW-B,II,IV,I,ETW-ABC aaaya aehia ab cy ez fx gs ht il jo mq nw uv           │
├──────────────────────────────────────────────────────────────────┬───────────┤
│ axbeleniaugangmunenwpalmjexifotbeexyerdwietsndfxanzeiedtxerxstel   -8.608253 │
│ UKW-B,I,IV,V,ETW-ABC aaasa altha aq br dm el fg iw js nv op yz               │
╞══════════════════════════════════════════════════════════════════╤═══════════╡
│ tsunqrtliabftqrnuwlqvnitrsctnqipklmaheefdcabcuworubswyrbggfdtxcb   -10.07245 │
│ Unchanged ciphertext (92 letters)                                            │
└──────────────────────────────────────────────────────────────────────────────┘
```

When the query completes or the program is terminated by the SIGINT  (pressing `Ctrl+C`) or SIGTERM signal, the full hold is printed out before exiting.

## Measures

In passes built-in measures can be specified that should be used to score and compare putative plaintext.

Many measures are based on n-grams (substrings of length n). These are specified by the tokens `monogram`, `bigram`, `trigram`, `quadgram`, `pentagram`, and `hexagram` for 1-grams, 2-grams, …, and 6-grams respectively.

Token | Measure
----- | -------
`sinkov_{n-gram}` | [Sinkov statistic](https://en.wikipedia.org/wiki/Sinkov_statistic) or log-weight statistic for n-grams (1 ≤ n ≤ 6);<br> Requires a frequency map
`ic` | [Index of coincidence](https://en.wikipedia.org/wiki/Index_of_coincidence) measure
`ic_{n-gram}` | [Index of coincidence](https://en.wikipedia.org/wiki/Index_of_coincidence) measure for n-grams (2 ≤ n ≤ 6)
`entropy` | [Shannon entropy](https://en.wikipedia.org/wiki/Entropy_(information_theory)) measure
`entropy_{n-gram}` | [Shannon entropy](https://en.wikipedia.org/wiki/Entropy_(information_theory)) measure for n-grams (2 ≤ n ≤ 6)

## Build from source

First, make sure the libraries [jansson](https://github.com/akheron/jansson) and [criterion](https://github.com/Snaipe/Criterion) are available to the compiler.

Build and test the program using make:

```bash
make clean && make test && make build
```

## Sources and References

### Frequency of English text

The following frequency tables were generated by [Practical Cryptography](http://practicalcryptography.com/cryptanalysis/letter-frequencies-various-languages/english-letter-frequencies/) from around 4.5 billion characters of English text, sourced from [Wortschatz](https://wortschatz-leipzig.de/en).

- `en-bigram.txt`
- `en-trigram.txt`

### Frequency of raw 1941 Enigma message decrypts

The following frequency tables have been published on [Frode Weierud's CryptoCellar](https://cryptocellar.org/bgac/keyofE.html).

- `enigma1941-bigram.txt`
- `enigma1941-trigram.txt`

## License

The source code in this repository is published under the MIT license. See [LICENSE.txt](LICENSE.txt).
